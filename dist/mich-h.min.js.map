{"version":3,"file":"mich-h.min.js","sources":["../src/index.js","../node_modules/mich-parse-selector/index.js"],"sourcesContent":["/*!\n * mich-h <https://github.com/tunnckoCore/mich-h>\n *\n * Copyright (c) Charlike Mike Reagent <@tunnckoCore> (https://i.am.charlike.online)\n * Released under the MIT license.\n */\n\nimport parseSelector from 'mich-parse-selector'\n\n/**\n * > Virtual DOM builder that is compatible to [hyperscript][],\n * so it takes any number of arguments that can be string,\n * object, or array. But the first one `selector` always should\n * be a simple css-like selector supported by [mich-parse-selector][].\n * For example `.foo.bar` creates a node with tag name `div`\n * and classes `foo bar`. Or selector like `p.foo#hero.bar` creates\n * a node with id `hero`, classes `foo` and `bar`, and tag name `p`.\n *\n * **Example**\n *\n * ```js\n * const h = require('mich-h')\n *\n * const node = h('a.foo#brand.bar.btn-large.xyz', {\n *   className: 'btn'\n *   href: 'https://i.am.charlike.online'\n * }, 'Charlike Web')\n *\n * console.log(node.type) // => 'element'\n * console.log(node.tagName) // => 'p'\n * console.log(node.properties.id) // => 'brand'\n *\n * console.log(node.properties.href)\n * // => 'https://i.am.charlike.online'\n *\n * console.log(node.properties.className)\n * // => [ 'foo', 'bar', 'btn-large', 'xyz', 'btn' ]\n *\n * console.log(node.children.length) // => 1\n * console.log(node.children[0])\n * // => { type: 'text', value: 'Charlike Web' }\n * ```\n *\n * @name   michH\n * @param  {String} `selector` simple selector; supports IDs, classes and tag name only\n * @param  {Object} `props` an attributes for the tag; can be in any position (i.e 4th)\n * @param  {String|Array} `children` a child nodes; can be in any position (i.e. 2nd or 5th)\n * @return {Object} a HAST compliant node\n * @api public\n */\n\nexport default function michH (selector) {\n  var isComponent = typeof selector === 'function'\n  var node = isComponent ? parseSelector() : parseSelector(selector)\n  var args = [].slice.call(arguments, 1)\n\n  function item (arg) {\n    if (arg) {\n      if (arg.map) {\n        while (arg.length) {\n          addChild(node.children, arg.shift())\n        }\n      } else if (typeof arg === 'object' && !isNode(arg)) {\n        for (var prop in arg) {\n          addProperty(node.properties, prop, arg[prop])\n        }\n      } else {\n        addChild(node.children, arg)\n      }\n    }\n  }\n\n  while (args.length) {\n    item(args.shift())\n  }\n\n  if (isComponent) {\n    return selector(node.properties, node.children)\n  }\n\n  return node\n}\n\nfunction isNode (val) {\n  return val.tagName &&\n    val.properties &&\n    typeof val.properties === 'object' &&\n    Array.isArray(val.children) &&\n    val.type === 'element'\n}\n\nfunction addChild (nodes, children) {\n  var type = typeof children\n  if (type === 'string' || type === 'number') {\n    children = {\n      type: 'text',\n      value: children + ''\n    }\n  }\n  nodes.push(children)\n}\n\nfunction addProperty (props, key, value) {\n  if (key === 'style' && value && typeof value === 'object') {\n    props.style = props.style || {}\n    for (var k in value) {\n      props.style[k] = value[k]\n    }\n  }\n\n  if (key === 'className') {\n    value = typeof value === 'string' ? value.split(' ') : value\n    props[key] = (props[key] || []).concat(value)\n  } else if (key.slice(0, 5) === 'data-') {\n    props.dataset = props.dataset || {}\n    props.dataset[key.slice(5)] = value\n  } else {\n    props[key] = value\n  }\n}\n","/*!\n * mich-parse-selector <https://github.com/tunnckoCore/mich-parse-selector>\n *\n * Copyright (c) Charlike Mike Reagent <@tunnckoCore> (https://i.am.charlike.online)\n * Copyright (c) Titus Wormer <tituswormer@gmail.com> (http://wooorm.com)\n * Released under the MIT license.\n */\n\n/**\n * > Parse a simple CSS selector like `p.foo#hero.btn-large.btn` into\n * a [HAST](https://github.com/syntax-tree/hast) node, which is a specification\n * for the Html (or Hypertext) Abstract Syntax Tree.\n * If \"tag name\" is omitted it defaults to `div`.\n *\n * **Example**\n *\n * ```js\n * const parseSelector = require('mich-parse-selector')\n *\n * const divNode = parseSelector('.bar')\n * const node = parseSelector('p.foo#hero.btn-large.btn')\n *\n * console.log(divNode)\n * // => {\n * //  type: 'element',\n * //  tagName: 'div',\n * //  properties: { className: [ 'bar' ] },\n * //  children: []\n * // }\n *\n * console.log(node)\n * // => {\n * //  type: 'element',\n * //  tagName: 'p',\n * //  properties: { id: 'hero', className: [ 'foo', 'btn-large', 'btn' ] },\n * //  children: []\n * // }\n * ```\n *\n * @name   michParseSelector\n * @param  {String} `selector` a css selector\n * @return {Object} a [HAST](https://github.com/syntax-tree/hast)-compliant node object\n * @api public\n */\n\nmodule.exports = function parse (selector) {\n  var type\n  var lastIndex\n\n  var index = 0\n  var className = []\n\n  var node = {\n    type: 'element',\n    tagName: 'div',\n    properties: {},\n    children: []\n  }\n\n  selector = selector || ''\n\n  while (index <= selector.length) {\n    var ch = selector[index++]\n\n    if (!ch || ch === '.' || ch === '#') {\n      var value = selector.slice(lastIndex, index - 1)\n\n      if (value) {\n        if (type === '.') {\n          className.push(value)\n        } else if (type === '#') {\n          node.properties.id = value\n        } else {\n          node.tagName = value\n        }\n      }\n\n      lastIndex = index\n      type = ch\n    }\n  }\n\n  if (className.length) {\n    node.properties.className = className\n  }\n\n  return node\n}\n"],"names":["michH","selector","item","arg","map","length","addChild","node","children","shift","isNode","prop","addProperty","properties","isComponent","parseSelector","args","slice","call","arguments","val","tagName","Array","isArray","type","nodes","value","push","props","key","style","k","split","concat","dataset","lastIndex","index","className","ch","id"],"mappings":"oKAmDA,QAAwBA,GAAOC,GAK7B,QAASC,GAAMC,GACb,GAAIA,EACF,GAAIA,EAAIC,IACN,KAAOD,EAAIE,QACTC,EAASC,EAAKC,SAAUL,EAAIM,aAEzB,IAAmB,gBAARN,IAAqBO,EAAOP,GAK5CG,EAASC,EAAKC,SAAUL,OAJxB,KAAK,GAAIQ,KAAQR,GACfS,EAAYL,EAAKM,WAAYF,EAAMR,EAAIQ,IAQ/C,IApBA,GAAIG,GAAkC,kBAAbb,GACrBM,EAAOO,EAAcC,IAAkBA,EAAcd,GACrDe,KAAUC,MAAMC,KAAKC,UAAW,GAkB7BH,EAAKX,QACVH,EAAKc,EAAKP,QAGZ,OAAIK,GACKb,EAASM,EAAKM,WAAYN,EAAKC,UAGjCD,EAGT,QAASG,GAAQU,GACf,MAAOA,GAAIC,SACTD,EAAIP,YACsB,gBAAnBO,GAAIP,YACXS,MAAMC,QAAQH,EAAIZ,WACL,YAAbY,EAAII,KAGR,QAASlB,GAAUmB,EAAOjB,GACxB,GAAIgB,SAAchB,EACL,YAATgB,GAA8B,WAATA,IACvBhB,GACEgB,KAAM,OACNE,MAAOlB,EAAW,KAGtBiB,EAAME,KAAKnB,GAGb,QAASI,GAAagB,EAAOC,EAAKH,GAChC,GAAY,UAARG,GAAmBH,GAA0B,gBAAVA,GAAoB,CACzDE,EAAME,MAAQF,EAAME,SACpB,KAAK,GAAIC,KAAKL,GACZE,EAAME,MAAMC,GAAKL,EAAMK,GAIf,cAARF,GACFH,EAAyB,gBAAVA,GAAqBA,EAAMM,MAAM,KAAON,EACvDE,EAAMC,IAAQD,EAAMC,QAAYI,OAAOP,IACV,UAApBG,EAAIZ,MAAM,EAAG,IACtBW,EAAMM,QAAUN,EAAMM,YACtBN,EAAMM,QAAQL,EAAIZ,MAAM,IAAMS,GAE9BE,EAAMC,GAAOH,ECxEjB,MAAiB,SAAgBzB,GAC/B,GAAIuB,GACAW,EAEAC,EAAQ,EACRC,KAEA9B,GACFiB,KAAM,UACNH,QAAS,MACTR,cACAL,YAKF,KAFAP,EAAWA,GAAY,GAEhBmC,GAASnC,EAASI,QAAQ,CAC/B,GAAIiC,GAAKrC,EAASmC,IAElB,KAAKE,GAAa,MAAPA,GAAqB,MAAPA,EAAY,CACnC,GAAIZ,GAAQzB,EAASgB,MAAMkB,EAAWC,EAAQ,EAE1CV,KACW,MAATF,EACFa,EAAUV,KAAKD,GACG,MAATF,EACTjB,EAAKM,WAAW0B,GAAKb,EAErBnB,EAAKc,QAAUK,GAInBS,EAAYC,EACZZ,EAAOc,GAQX,MAJID,GAAUhC,SACZE,EAAKM,WAAWwB,UAAYA,GAGvB9B"}